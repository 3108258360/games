<!doctype html><html lang=zh><head><meta charset=UTF-8><link rel="shortcut icon" href=favicon.ico type=image/x-icon><title>Emulator</title><meta name=viewport content="width=device-width,initial-scale=1"><style>.ejs_dpad_main,.ejs_virtualGamepad_button,.ejs_virtualGamepad_open,.nipple{position:absolute!important;touch-action:none}body,html{height:100%;background-color:#000;color:#fff}body{margin:0;overflow:hidden}#box,body{display:flex;align-items:center;justify-content:center;flex-direction:column}#box{color:#aaa;height:20em;width:30em;max-width:80%;max-height:80%;background-color:#333;border-radius:.4em;border:2px solid #555;position:relative;flex-direction:column;transition-duration:.2s;overflow:hidden;font-family:monospace;font-weight:700;font-size:20px;margin:5px}#box:hover,#box[drag]{border-color:#38f;color:#ddd}#input{cursor:pointer;position:absolute;left:0;top:0;width:100%;height:100%;opacity:0}#display{width:100%;height:100%}button,select{padding:.6em .4em;margin:.5em;width:15em;max-width:100%;font-family:monospace;font-weight:700;font-size:16px;background-color:#444;color:#aaa;border-radius:.4em;border:1px solid #555;cursor:pointer;transition-duration:.2s}button:hover,select:hover{background-color:#666;color:#ddd}</style></head><body><div id=box><input type=file id=input>添加ROM</div><script>const params=new URLSearchParams(window.location.search),urlParam=params.get("url"),extParam=params.get("ext"),input=document.getElementById("input");async function loadGame(e,t,n){const o=(t?t.name:e).split("."),a=o.pop(),c=n||a,s=await(async e=>["fds","nes","unif","unf"].includes(e)?"nes":["smc","fig","sfc","gd3","gd7","dx2","bsx","swc"].includes(e)?"snes":["z64","n64"].includes(e)?"n64":["pce"].includes(e)?"pce":["ngp","ngc"].includes(e)?"ngp":["ws","wsc"].includes(e)?"ws":["col","cv"].includes(e)?"coleco":["d64"].includes(e)?"vice_x64sc":["nds","gba","gb"].includes(e)?e:await new Promise((e=>{var t={"Nintendo 64":"n64","Nintendo Game Boy":"gb","Nintendo Game Boy Advance":"gba","Nintendo DS":"nds","Nintendo Entertainment System":"nes","Super Nintendo Entertainment System":"snes",PlayStation:"psx","Virtual Boy":"vb","Sega Mega Drive":"segaMD","Sega Master System":"segaMS","Sega CD":"segaCD","Atari Lynx":"lynx","Sega 32X":"sega32x","Atari Jaguar":"jaguar","Sega Game Gear":"segaGG","Sega Saturn":"segaSaturn","Atari 7800":"atari7800","Atari 2600":"atari2600",Arcade:"arcade","NEC TurboGrafx-16/SuperGrafx/PC Engine":"pce","NEC PC-FX":"pcfx","SNK NeoGeo Pocket (Color)":"ngp","Bandai WonderSwan (Color)":"ws",ColecoVision:"coleco","Commodore 64":"vice_x64sc","Commodore 128":"vice_x128","Commodore VIC20":"vice_xvic","Commodore Plus/4":"vice_xplus4","Commodore PET":"vice_xpet"};const n=Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{}),o=document.createElement("button"),a=document.createElement("select");for(const e in n){const t=document.createElement("option");t.value=n[e],t.textContent=e,a.appendChild(t)}o.onclick=()=>e(a[a.selectedIndex].value),o.textContent="Load game",box.innerHTML="",box.appendChild(a),box.appendChild(o)})))(c),r=document.createElement("div"),d=document.createElement("div"),i=document.createElement("script");d.id="game",r.id="display",box.remove(),r.appendChild(d),document.body.appendChild(r),window.EJS_Buttons={screenRecord:!1,exitEmulation:!1},window.EJS_player="#game",window.EJS_gameName=o.shift(),document.title=window.EJS_gameName,window.EJS_biosUrl="",window.EJS_volume=1,window.EJS_gameUrl=t?URL.createObjectURL(t):e,window.EJS_core=s,window.EJS_pathtodata="data/",window.EJS_startOnLoaded=!0,window.EJS_disableDatabases=!0,window.EJS_DEBUG_XX=!1,window.EJS_threads=!1,window.EJS_language="zh-CN",i.src="data/loader.js",document.body.appendChild(i)}null!=urlParam?loadGame(urlParam,null,extParam):input.onchange=()=>loadGame(null,input.files[0]),box.ondragover=()=>box.setAttribute("drag",!0),box.ondragleave=()=>box.removeAttribute("drag"),window.EJS_onGameStart=function(e){const t=()=>[...document.querySelectorAll(".ejs_virtualGamepad_button"),...document.querySelectorAll(".ejs_dpad_main"),document.querySelector(".ejs_virtualGamepad_open"),...document.querySelectorAll(".nipple")];(()=>{const e=JSON.parse(localStorage.getItem(`${extParam}_positions`))||{};t().forEach((t=>{t&&e[t.className]&&(t.style.left=e[t.className].left,t.style.top=e[t.className].top)}))})();const n=document.querySelector(".ejs_context_menu > ul"),o=e=>{const t=document.createElement("li");return t.innerHTML=`<a href="#">${e}</a>`,t};n.append(o("更改手柄位置")),n.append(o("保存手柄位置"));const a=new WeakMap,c=()=>{const e={};t().forEach((t=>{t&&(e[t.className]={left:t.style.left,top:t.style.top})})),localStorage.setItem(`${extParam}_positions`,JSON.stringify(e))};document.querySelectorAll(".ejs_context_menu > ul > li").forEach((e=>{e.textContent.includes("更改手柄位置")&&(e.onclick=()=>t().forEach((e=>{e.style.zIndex="1",(e=>{a.has(e)&&e.removeEventListener("touchstart",a.get(e));const t=t=>{const n=t.touches[0],o=e.offsetLeft-n.clientX,a=e.offsetTop-n.clientY,s=t=>{const n=t.touches[0];e.style.left=`${n.clientX+o}px`,e.style.top=`${n.clientY+a}px`},r=()=>{e.removeEventListener("touchmove",s),e.removeEventListener("touchend",r),c()};e.addEventListener("touchmove",s),e.addEventListener("touchend",r)};a.set(e,t),e.addEventListener("touchstart",t)})(e)}))),e.textContent.includes("保存手柄位置")&&(e.onclick=()=>{c(),t().forEach((e=>{a.has(e)&&(e.removeEventListener("touchstart",a.get(e)),a.delete(e))}))})}))}</script></body></html>